# Change: 创建独立的任务管理模块

## Why

当前系统的任务管理功能分散在多个文件中，存在高耦合、缺乏标准化、扩展性差等问题：

- **高耦合问题**：任务控制逻辑与业务逻辑混合在GoodStoreSelector中，违反单一职责原则
- **分散管理**：控制点检查分散在各业务方法中，维护困难
- **缺乏标准化**：不同组件使用任务控制的方式不一致
- **扩展性差**：新增控制点需要修改业务代码，违反开闭原则
- **复用性低**：任务管理功能无法在其他模块中复用

需要创建一个独立的、模块化的任务管理系统来解决这些架构问题。

## What Changes

创建全新的独立任务管理模块 `task_manager/`，包含以下核心改进：

- **模块化架构**：按职责分离的清晰目录结构
- **标准化接口**：统一的任务控制和状态管理接口
- **事件驱动设计**：使用事件机制解耦任务管理与业务逻辑
- **配置化控制点**：支持灵活的控制点配置而非硬编码
- **向后兼容**：保持现有API的兼容性，支持渐进式迁移

### 新增功能

- 独立的任务生命周期管理（创建、启动、暂停、恢复、停止、销毁）
- 统一的任务状态机管理
- 标准化的进度跟踪和事件通知机制
- 跨进程任务控制能力
- 可配置的控制点检查策略

### 影响现有代码

- **无破坏性变更**：通过适配器模式保持现有接口兼容
- **渐进式迁移**：现有代码可逐步迁移到新架构
- **性能优化**：统一的任务管理减少重复代码和资源浪费

## Impact

### 受影响的规范
- **新增**: `task-manager` - 新的任务管理能力规范

### 受影响的代码
- **新增**: `task_manager/` 目录及所有子模块
- **兼容性**: 现有的 `common/task_control.py` 和 `cli/task_controller.py` 保持兼容
- **集成点**: `good_store_selector.py`, `common/services/scraping_orchestrator.py`

### 迁移计划
1. **Phase 1**: 创建独立task_manager模块
2. **Phase 2**: 实现向后兼容的适配器
3. **Phase 3**: 逐步迁移现有代码到新架构
4. **Phase 4**: 废弃旧的分散式实现（保留向后兼容）

### 风险评估
- **实施风险**: 低 - 新模块独立开发，不影响现有功能
- **迁移风险**: 低 - 通过适配器保持兼容性
- **维护收益**: 高 - 显著提升代码质量和可维护性

### 成功指标
- 任务管理相关代码减少30%以上重复
- 新增控制点的开发时间减少50%
- 任务控制响应时间提升至亚秒级
- 通过所有现有功能测试，确保向后兼容
