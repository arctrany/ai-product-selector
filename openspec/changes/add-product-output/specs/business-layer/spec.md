## ADDED Requirements

### Requirement: å•†å“Excelå†™å…¥å™¨
ç³»ç»Ÿå¿…é¡»ï¼ˆMUSTï¼‰æä¾›ç‹¬ç«‹çš„å•†å“Excelå†™å…¥å™¨ï¼Œè´Ÿè´£å°†å•†å“åˆ†æç»“æœå†™å…¥æ ‡å‡†åŒ–çš„Excelæ–‡ä»¶ã€‚

#### Scenario: åˆå§‹åŒ–å•†å“Excelæ–‡ä»¶
- **WHEN** åˆ›å»º `ExcelProductWriter` å®ä¾‹æ—¶æä¾›å•†å“æ–‡ä»¶è·¯å¾„
- **THEN** ç³»ç»Ÿåº”å½“éªŒè¯æ–‡ä»¶è·¯å¾„æœ‰æ•ˆæ€§
- **AND** å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„Excelæ–‡ä»¶å¹¶å†™å…¥è¡¨å¤´
- **AND** å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œæ‰“å¼€æ–‡ä»¶å‡†å¤‡è¿½åŠ æ•°æ®
- **AND** è¡¨å¤´åº”å½“åŒ…å«ï¼šåº—é“ºIDã€å•†å“IDã€å•†å“åç§°ã€å•†å“å›¾ç‰‡ã€ç»¿æ ‡ä»·æ ¼ã€é»‘æ ‡ä»·æ ¼ã€ä½£é‡‘ç‡ã€é‡é‡ã€é•¿å®½é«˜ã€è´§æºä»·æ ¼ã€åˆ©æ¶¦ç‡ã€é¢„è®¡åˆ©æ¶¦

#### Scenario: å†™å…¥å•ä¸ªå•†å“æ•°æ®
- **WHEN** è°ƒç”¨ `write_product(product_result)` æ–¹æ³•
- **THEN** ç³»ç»Ÿåº”å½“å°† `ProductAnalysisResult` è½¬æ¢ä¸ºExcelè¡Œæ•°æ®
- **AND** å†™å…¥åˆ°ä¸‹ä¸€ä¸ªç©ºè¡Œ
- **AND** æ‰€æœ‰æ•°å€¼å­—æ®µåº”å½“æ ¼å¼åŒ–ä¸ºæ­£ç¡®çš„æ•°æ®ç±»å‹ï¼ˆæ•°å­—ã€ç™¾åˆ†æ¯”ï¼‰
- **AND** ä»·æ ¼å­—æ®µä¿ç•™2ä½å°æ•°
- **AND** åˆ©æ¶¦ç‡å­—æ®µæ˜¾ç¤ºä¸ºç™¾åˆ†æ¯”ï¼ˆå¦‚ 15.5%ï¼‰

#### Scenario: æ‰¹é‡å†™å…¥å•†å“æ•°æ®
- **WHEN** è°ƒç”¨ `batch_write_products(product_list)` æ–¹æ³•
- **THEN** ç³»ç»Ÿåº”å½“éå†æ‰€æœ‰å•†å“å¹¶é€ä¸ªå†™å…¥
- **AND** ä½¿ç”¨æ‰¹é‡å†™å…¥ä¼˜åŒ–æ€§èƒ½ï¼ˆæ¯100æ¡æäº¤ä¸€æ¬¡ï¼‰
- **AND** å†™å…¥å®Œæˆåè‡ªåŠ¨ä¿å­˜æ–‡ä»¶
- **AND** è¿”å›æˆåŠŸå†™å…¥çš„å•†å“æ•°é‡

#### Scenario: å¤„ç†ç¼ºå¤±å­—æ®µ
- **WHEN** å•†å“æ•°æ®ä¸­æŸäº›å­—æ®µä¸º None æˆ–ç¼ºå¤±
- **THEN** ç³»ç»Ÿåº”å½“ä½¿ç”¨é»˜è®¤å€¼æˆ–ç©ºå­—ç¬¦ä¸²å¡«å……
- **AND** æ•°å€¼å­—æ®µä½¿ç”¨ 0 ä½œä¸ºé»˜è®¤å€¼
- **AND** å­—ç¬¦ä¸²å­—æ®µä½¿ç”¨ç©ºå­—ç¬¦ä¸²ä½œä¸ºé»˜è®¤å€¼
- **AND** è®°å½•è­¦å‘Šæ—¥å¿—ä½†ä¸ä¸­æ–­å†™å…¥

#### Scenario: å†™å…¥å¤±è´¥æ—¶çš„é”™è¯¯å¤„ç†
- **WHEN** å†™å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼ˆå¦‚ç£ç›˜ç©ºé—´ä¸è¶³ã€æƒé™é—®é¢˜ï¼‰
- **THEN** ç³»ç»Ÿåº”å½“æŠ›å‡º `ExcelProcessingError` å¼‚å¸¸
- **AND** å¼‚å¸¸æ¶ˆæ¯åº”å½“åŒ…å«è¯¦ç»†çš„é”™è¯¯åŸå› å’Œå¤±è´¥çš„å•†å“ID
- **AND** å·²å†™å…¥çš„æ•°æ®åº”å½“ä¿ç•™ï¼ˆä¸å›æ»šï¼‰
- **AND** è®°å½•é”™è¯¯æ—¥å¿—åŒ…å«å †æ ˆè·Ÿè¸ª

### Requirement: å•†å“è¾“å‡ºæµç¨‹é›†æˆ
ç³»ç»Ÿå¿…é¡»ï¼ˆMUSTï¼‰åœ¨ä¸»æµç¨‹ä¸­é›†æˆå•†å“è¾“å‡ºé€»è¾‘ï¼Œæ ¹æ®é€‰æ‹©æ¨¡å¼å†³å®šè¾“å‡ºç›®æ ‡ã€‚

#### Scenario: Select-Goods æ¨¡å¼è¾“å‡ºå•†å“
- **WHEN** ç³»ç»Ÿè¿è¡Œåœ¨ select-goods æ¨¡å¼ä¸”å®Œæˆå•†å“æŠ“å–å’Œåˆ©æ¶¦è®¡ç®—
- **THEN** ç³»ç»Ÿåº”å½“ä»æ‰€æœ‰ `StoreAnalysisResult` ä¸­æå–å•†å“åˆ—è¡¨
- **AND** è¿‡æ»¤å‡ºåˆ©æ¶¦ç‡ >= é…ç½®é˜ˆå€¼çš„å•†å“
- **AND** æŒ‰åº—é“ºIDå’Œåˆ©æ¶¦ç‡é™åºæ’åº
- **AND** è°ƒç”¨ `ExcelProductWriter.batch_write_products()` å†™å…¥å•†å“Excel
- **AND** ä¸æ›´æ–°åº—é“ºExcelæ–‡ä»¶

#### Scenario: Select-Shops æ¨¡å¼ä¿æŒåŸæœ‰è¡Œä¸º
- **WHEN** ç³»ç»Ÿè¿è¡Œåœ¨ select-shops æ¨¡å¼
- **THEN** ç³»ç»Ÿåº”å½“æŒ‰åŸæœ‰é€»è¾‘æ›´æ–°åº—é“ºExcel
- **AND** ä¸æ‰§è¡Œå•†å“Excelå†™å…¥æ“ä½œ
- **AND** ä¸åˆå§‹åŒ– `ExcelProductWriter`

#### Scenario: Dryrun æ¨¡å¼ä¸‹çš„å•†å“è¾“å‡º
- **WHEN** ç³»ç»Ÿè¿è¡Œåœ¨ dryrun æ¨¡å¼ä¸”é€‰æ‹© select-goods æ¨¡å¼
- **THEN** ç³»ç»Ÿåº”å½“æ‰§è¡Œå®Œæ•´çš„å•†å“æŠ“å–å’Œåˆ©æ¶¦è®¡ç®—
- **AND** æ¨¡æ‹Ÿå•†å“Excelå†™å…¥æ“ä½œï¼ˆè®°å½•æ—¥å¿—ä½†ä¸å®é™…å†™å…¥æ–‡ä»¶ï¼‰
- **AND** åœ¨æ—¥å¿—ä¸­è¾“å‡ºå°†è¦å†™å…¥çš„å•†å“æ•°é‡å’Œæ ·ä¾‹æ•°æ®
- **AND** æ˜¾ç¤º "ğŸ§ª è¯•è¿è¡Œæ¨¡å¼ï¼šæ¨¡æ‹Ÿå•†å“Excelå†™å…¥" æç¤º

#### Scenario: å•†å“æ•°æ®æ”¶é›†å’Œè½¬æ¢
- **WHEN** éœ€è¦ä» `StoreAnalysisResult` åˆ—è¡¨ä¸­æå–å•†å“æ•°æ®
- **THEN** ç³»ç»Ÿåº”å½“éå†æ‰€æœ‰åº—é“ºç»“æœ
- **AND** æå–æ¯ä¸ªåº—é“ºçš„ `products` åˆ—è¡¨
- **AND** ä¸ºæ¯ä¸ªå•†å“æ·»åŠ  `store_id` å­—æ®µï¼ˆæ¥è‡ªåº—é“ºä¿¡æ¯ï¼‰
- **AND** ä¿ç•™æ‰€æœ‰å•†å“çš„å®Œæ•´æ•°æ®ï¼ˆåŒ…æ‹¬è·Ÿå–ä¿¡æ¯ï¼Œä½†ä¸å†™å…¥Excelï¼‰
- **AND** è¿”å›æ‰å¹³åŒ–çš„å•†å“åˆ—è¡¨

### Requirement: å•†å“æ•°æ®æ¨¡å‹å®šä¹‰
ç³»ç»Ÿå¿…é¡»ï¼ˆMUSTï¼‰å®šä¹‰å•†å“Excelæ•°æ®æ¨¡å‹ï¼Œç¡®ä¿æ•°æ®ç»“æ„æ ‡å‡†åŒ–ã€‚

#### Scenario: å•†å“Excelæ•°æ®ç±»å®šä¹‰
- **WHEN** åœ¨ `common/models/excel_models.py` ä¸­å®šä¹‰ `ExcelProductData`
- **THEN** æ•°æ®ç±»åº”å½“åŒ…å«ä»¥ä¸‹å­—æ®µï¼š
  - `store_id: str` - åº—é“ºID
  - `product_id: str` - å•†å“ID
  - `product_name: Optional[str]` - å•†å“åç§°
  - `image_url: Optional[str]` - å•†å“å›¾ç‰‡URL
  - `green_price: Optional[float]` - ç»¿æ ‡ä»·æ ¼ï¼ˆå¢å¸ƒï¼‰
  - `black_price: Optional[float]` - é»‘æ ‡ä»·æ ¼ï¼ˆå¢å¸ƒï¼‰
  - `commission_rate: Optional[float]` - ä½£é‡‘ç‡
  - `weight: Optional[float]` - é‡é‡ï¼ˆå…‹ï¼‰
  - `length: Optional[float]` - é•¿åº¦ï¼ˆå˜ç±³ï¼‰
  - `width: Optional[float]` - å®½åº¦ï¼ˆå˜ç±³ï¼‰
  - `height: Optional[float]` - é«˜åº¦ï¼ˆå˜ç±³ï¼‰
  - `source_price: Optional[float]` - è´§æºä»·æ ¼ï¼ˆäººæ°‘å¸ï¼‰
  - `profit_rate: Optional[float]` - åˆ©æ¶¦ç‡
  - `profit_amount: Optional[float]` - é¢„è®¡åˆ©æ¶¦ï¼ˆäººæ°‘å¸ï¼‰
- **AND** æ‰€æœ‰å­—æ®µåº”å½“æœ‰ç±»å‹æ³¨è§£
- **AND** æä¾› `from_product_analysis_result()` ç±»æ–¹æ³•ç”¨äºæ•°æ®è½¬æ¢

#### Scenario: å•†å“æ•°æ®éªŒè¯
- **WHEN** åˆ›å»º `ExcelProductData` å®ä¾‹
- **THEN** ç³»ç»Ÿåº”å½“éªŒè¯å¿…éœ€å­—æ®µä¸ä¸ºç©ºï¼ˆ`store_id`, `product_id`ï¼‰
- **AND** éªŒè¯æ•°å€¼å­—æ®µçš„åˆç†èŒƒå›´ï¼ˆä»·æ ¼ > 0ï¼Œåˆ©æ¶¦ç‡ -100% ~ 100%ï¼‰
- **AND** éªŒè¯URLå­—æ®µæ ¼å¼æ­£ç¡®ï¼ˆå¦‚æœæä¾›ï¼‰
- **AND** å¦‚æœéªŒè¯å¤±è´¥ï¼ŒæŠ›å‡º `DataValidationError`

### Requirement: å•†å“Excelé…ç½®
ç³»ç»Ÿå¿…é¡»ï¼ˆMUSTï¼‰åœ¨é…ç½®å±‚æä¾›å•†å“Excelçš„åˆ—æ˜ å°„é…ç½®ï¼Œæ”¯æŒçµæ´»è°ƒæ•´è¾“å‡ºæ ¼å¼ã€‚

#### Scenario: å•†å“Excelåˆ—é…ç½®å®šä¹‰
- **WHEN** åœ¨ `common/config/business_config.py` çš„ `ExcelConfig` ä¸­æ·»åŠ å•†å“åˆ—é…ç½®
- **THEN** åº”å½“å®šä¹‰ä»¥ä¸‹é…ç½®å­—æ®µï¼š
  - `product_store_id_column: str = "A"` - åº—é“ºIDåˆ—
  - `product_id_column: str = "B"` - å•†å“IDåˆ—
  - `product_name_column: str = "C"` - å•†å“åç§°åˆ—
  - `product_image_column: str = "D"` - å•†å“å›¾ç‰‡åˆ—
  - `product_green_price_column: str = "E"` - ç»¿æ ‡ä»·æ ¼åˆ—
  - `product_black_price_column: str = "F"` - é»‘æ ‡ä»·æ ¼åˆ—
  - `product_commission_column: str = "G"` - ä½£é‡‘ç‡åˆ—
  - `product_weight_column: str = "H"` - é‡é‡åˆ—
  - `product_dimensions_column: str = "I"` - å°ºå¯¸åˆ—ï¼ˆé•¿å®½é«˜åˆå¹¶ï¼‰
  - `product_source_price_column: str = "L"` - è´§æºä»·æ ¼åˆ—
  - `product_profit_rate_column: str = "M"` - åˆ©æ¶¦ç‡åˆ—
  - `product_profit_amount_column: str = "N"` - é¢„è®¡åˆ©æ¶¦åˆ—
- **AND** æ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶è¦†ç›–é»˜è®¤åˆ—ä½ç½®

#### Scenario: ä½¿ç”¨é…ç½®è¿›è¡Œåˆ—æ˜ å°„
- **WHEN** `ExcelProductWriter` å†™å…¥æ•°æ®æ—¶
- **THEN** åº”å½“ä» `ExcelConfig` è¯»å–åˆ—é…ç½®
- **AND** æ ¹æ®é…ç½®å°†æ•°æ®å†™å…¥å¯¹åº”çš„åˆ—
- **AND** å¦‚æœé…ç½®ç¼ºå¤±ï¼Œä½¿ç”¨é»˜è®¤åˆ—ä½ç½®
